{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2024-01-08T16:39:18.092716Z", "invocation_id": "524f4145-3446-4a76-8f81-2f792d569d8b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-08T16:39:03.491934Z", "completed_at": "2024-01-08T16:39:07.536367Z"}, {"name": "execute", "started_at": "2024-01-08T16:39:07.544339Z", "completed_at": "2024-01-08T16:39:18.062647Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 14.585975646972656, "adapter_response": {"_message": "MERGE (16.4k rows, 376.7 MiB processed)", "code": "MERGE", "rows_affected": 16436, "bytes_processed": 395014673, "bytes_billed": 395313152, "location": "US", "project_id": "edm-saras", "job_id": "1dfe5886-42cd-46ab-9eb2-e96f55b3dc3a", "slot_ms": 312618}, "message": "MERGE (16.4k rows, 376.7 MiB processed)", "failures": null, "unique_id": "model.klaviyo.KlaviyoClickedEmail", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n        select\n        'Brand'\n as brand,\n        'US'\n as store,\n        type,\n        coalesce(id) as id,\n        \n\n    \n    cast(attributes.metric_id as string)\n    \n    \n as attributes_metric_id,\n        \n\n    \n    cast(attributes.profile_id as string)\n    \n    \n as attributes_profile_id,\n        timestamp_seconds(\n\n    \n    cast(attributes.timestamp as int64)\n    \n    \n) as attributes_timestamp,\n        \n\n    \n    cast(event_properties.Subject as string)\n    \n    \n as event_properties_Subject,\n        \n\n    \n    cast(event_properties.Campaign_Name as string)\n    \n    \n as event_properties_Campaign_Name,\n        \n\n    \n    cast(event_properties.flow as string)\n    \n    \n as event_properties_flow,\n        \n\n    \n    cast(event_properties.message as string)\n    \n    \n as event_properties_message,\n        \n\n    \n    cast(event_properties.Email_Domain as string)\n    \n    \n as event_properties_Email_Domain,\n        \n\n    \n    cast(event_properties.cohort_message_send_cohort as string)\n    \n    \n as event_properties_cohort_message_send_cohort,\n        \n\n    \n    cast(event_properties.message_interaction as string)\n    \n    \n as event_properties_message_interaction,\n        \n\n    \n    cast(event_properties.URL as string)\n    \n    \n as event_properties_URL,\n        \n\n    \n    cast(event_properties.Client_Type as string)\n    \n    \n as event_properties_Client_Type,\n        \n\n    \n    cast(event_properties.Client_OS_Family as string)\n    \n    \n as event_properties_Client_OS_Family,\n        \n\n    \n    cast(event_properties.Client_OS as string)\n    \n    \n as event_properties_Client_OS,\n        \n\n    \n    cast(event_properties.Client_Name as string)\n    \n    \n as event_properties_Client_Name,\n        \n\n    \n    cast(event_properties._ip as string)\n    \n    \n as event_properties__ip,\n        \n\n    \n    cast(event_properties.ESP as numeric)\n    \n    \n as event_properties_ESP,\n        \n\n    \n    cast(event_properties.group_ids as string)\n    \n    \n as event_properties_group_ids,\n        \n\n    \n    cast(event_properties.event_id as string)\n    \n    \n as event_properties_event_id,\n        \n\n    \n    cast(event_properties.variation as string)\n    \n    \n as event_properties_variation,\n        \n\n    \n    cast(event_properties.cohort_variation_send_cohort as string)\n    \n    \n as event_properties_cohort_variation_send_cohort,\n        \n\n    \n    cast(event_properties.experiment as string)\n    \n    \n as event_properties_experiment,\n        \n\n    \n    cast(attribution.attributed_event_id as string)\n    \n    \n as attribution_attributed_event_id,\n        \n\n    \n    cast(attribution.send_ts as numeric)\n    \n    \n as attribution_send_ts,\n        \n\n    \n    cast(event_properties.`Inbox Provider` as string)\n    \n    \n as event_properties_Inbox_Provider,\n        date(\n \n    \n        DATETIME(cast(replace(replace(left(attributes.datetime,19),\"T\",\" \"),\"Z\",\":00\") as timestamp))\n    \n \n) date,\n        \n \n    \n        DATETIME(cast(replace(replace(left(attributes.datetime,19),\"T\",\" \"),\"Z\",\":00\") as timestamp))\n    \n \n as datetime,\n        \n \n    \n        DATETIME(cast(replace(replace(left(attributes.datetime,19),\"T\",\" \"),\"Z\",\":00\") as timestamp))\n    \n \n as _edm_eff_strt_ts,\n        uuid,\n        \n\n    \n    cast(links.self as string)\n    \n    \n as links_self,\n        _daton_user_id,\n        _daton_batch_runtime,\n        _daton_batch_id,\n        null as _edm_eff_end_ts,\n        unix_micros(current_timestamp()) as _edm_runtime\n        from edm-saras.EDM_Daton.Brand_US_Klaviyo_BQ_clicked_email a\n        \n\n    \n    left join unnest(attributes) as attributes\n    \n    \n\n        \n\n    \n    left join unnest(attributes.event_properties) event_properties\n    \n    \n\n        \n\n    \n    left join unnest(event_properties.attribution) attribution\n    \n    \n\n        \n\n    \n    left join unnest(links) as links\n    \n    \n\n    \n            \n            where _daton_batch_runtime  >= (select coalesce(max(_daton_batch_runtime) - 2592000000,0) from `edm-saras`.`edm`.`KlaviyoClickedEmail`)\n            \n    qualify row_number() over (partition by id order by _daton_batch_runtime desc) = 1\n    \n", "relation_name": "`edm-saras`.`edm`.`KlaviyoClickedEmail`"}], "elapsed_time": 18.277243614196777, "args": {"write_json": true, "log_file_max_bytes": 10485760, "defer": false, "log_level": "info", "profiles_dir": "Profiles", "send_anonymous_usage_stats": true, "show_resource_report": false, "printer_width": 80, "log_path": "C:\\Users\\91809\\GitHub\\klaviyo\\logs", "cache_selected_only": false, "indirect_selection": "eager", "log_level_file": "debug", "quiet": false, "log_format_file": "debug", "print": true, "static_parser": true, "vars": {}, "version_check": true, "project_dir": "C:\\Users\\91809\\GitHub\\klaviyo", "invocation_command": "dbt run --select KlaviyoClickedEmail --profiles-dir Profiles", "introspect": true, "select": ["KlaviyoClickedEmail"], "favor_state": false, "strict_mode": false, "enable_legacy_logger": false, "exclude": [], "macro_debugging": false, "populate_cache": true, "partial_parse": true, "log_format": "default", "partial_parse_file_diff": true, "warn_error_options": {"include": [], "exclude": []}, "use_colors": true, "which": "run", "use_colors_file": true}}